<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Respirapp</title>
    <!-- PWA -->
    <meta name="theme-color" content="#020617">
    <link rel="manifest" href="./manifest.webmanifest">
    <!-- iOS -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="./assets/icons/icon-192.png">
    <link rel="icon" type="image/x-icon" href="./assets/icons/favicon.ico">
    <link rel="stylesheet" href="./css/styles.css">
    <meta name="theme-color" content="#0c1220">
</head>

<body>
    <main>
        <div class="colaborar">
            <div class="about-cards">
                <a class="btn-ghost" href="https://link.mercadopago.com.ar/respirapp"
                    aria-label="Colaborar con el proyecto" target="_blank">
                    Colaborar ☕
                </a>
            </div>
        </div>

        <section class="home-spacer"></section>
        <!-- BLOQUE SUPERIOR -->
        <header class="home-header">
            <h1 class="home-title">
                <span class="respirapp" aria-label="RESPIRAPP">RESPIRAPP</span>
            </h1>

            <p class="home-subtitle">
                Respirá un momento. <br>
                El resto puede esperar.
            </p>
        </header>

        <!-- BLOQUE CENTRAL (vacío a propósito, da aire) -->
        <div class="order-btns">
            <!-- BLOQUE INFERIOR -->
            <a href="./pages/presets.html" class="home-cta">
                Comenzar
            </a>
            <br>

            <a href="#" id="openAudio" class="link-ghost home-link">
                Panel de Volumen
            </a>
            <a href="./pages/about.html" class="link-ghost home-link">
                Más info
            </a>
        </div>
    </main>
    <!-- Service Worker Registration -->
    <script src="./js/sw-register.js"></script>
    <script type="module" src="./js/audio_modal.js"></script>
    <script type="module">
        import { injectAudioModal, initAudioModal } from './js/audio_modal.js';
        injectAudioModal();
        initAudioModal({ openButtonSelector: '#openAudio' }); 
    </script>
    <script>
        // Solo ejecutar en app Android
        const isTWA = window.matchMedia('(display-mode: standalone)').matches;

        if (isTWA) {
            let backPressCount = 0;

            window.addEventListener('load', function () {
                window.history.pushState({ page: 'home' }, '', '');

                window.addEventListener('popstate', function () {
                    backPressCount++;

                    if (backPressCount === 1) {
                        alert('Presiona Atrás de nuevo para salir');
                        window.history.pushState({ page: 'home' }, '', '');
                        setTimeout(() => { backPressCount = 0; }, 2000);
                    }
                });
            });
        }
    </script>
</body>

</html>